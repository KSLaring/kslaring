define(["jquery","core/notification","core/log","core/ajax","core/templates","theme_bootstrapbase/bootstrap"],function($,e,a,l,s){"use strict";a.debug("AMD module categoryselect loaded.");var t=$("#category-select-form"),o=$("#category-select-select"),n=$("#category-select-list-container"),c=function(e){e.preventDefault();var a=$(e.target),s=a.closest("li"),t=null;a.hasClass("catname")?(t=o.find("option"),t.val(s.data("catid")),t.text(a.text())):a.hasClass("tree-icon")&&(s.hasClass("not-loaded")?$.when(l.call([{methodname:"local_friadmin_get_subcategories",args:{catid:s.data("catid")}}])[0]).then(function(e){var a=JSON.parse(e.subcategorieshtml);if(""!==a){var l=s.find(".content");l.html(a),l.addClass("in"),s.siblings("li").not(".collapsed").addClass("collapsed").find(".in").removeClass("in"),s.removeClass("collapsed not-loaded").find(".collapse").addClass("in")}}):s.hasClass("collapsed")?(s.siblings("li").not(".collapsed").addClass("collapsed").find(".in").removeClass("in"),s.removeClass("collapsed").find(".collapse").eq(0).addClass("in")):(s.addClass("collapsed").find(".collapse").removeClass("in"),s.find("li").addClass("collapsed")))},i=function(e){e.preventDefault(),n.collapse("show")};return{init:function(){a.debug("AMD module categoryselect init."),t.on("click",".catname, .tree-icon.with-children",c),o.on("click select",i)}}});