define(["jquery","core/notification","core/log","core/ajax","core/templates","local_course_search/cookie","local_course_search/ld_loader"],function($,t,e,i,n,a,r){"use strict";e.debug("AMD module viewstate loaded.");var o="viewstate",s=null,u=null,g=[[],[],[],[],[]],c={view:0,text:1,tags:2,date:3,display:4},l="0|||0,0|name,0,0",d=function(){var t="",i=[];g.forEach(function(t){i.push(t.join(","))}),t=i.join("|"),a.create(o,t,14),e.debug(t)};return{viewstate:s,viewstatearray:g,init:function(){e.debug("AMD module viewstate init."),s=a.read(o),null===s&&(s=l,a.create(o,l)),u=s.split("|"),u.forEach(function(t,e){t.length?g[e]=t.split(","):g[e]=[]}),e.debug(s),e.debug(g)},setView:function(t){g[c.view][0]=t.toString(),d(),$("body").trigger("viewstate:change",["view"])},getView:function(){return g[c.view][0]},setText:function(t){g[c.text][0]=t.replace(",","").toLowerCase(),d(),$("body").trigger("viewstate:change",["text"])},getText:function(){var t="";return g[c.text].length&&(t=g[c.text][0]),t},setTag:function(t,e){"remove"===e?r.remove(g[c.tags],function(e){return e.toString()===t.toString()}):-1===g[c.tags].indexOf(t.toString())&&g[c.tags].push(t.toString()),d(),$("body").trigger("viewstate:change",["tag"])},getTags:function(){return g[c.tags]},setDate:function(t,e){if("date-from"===e)g[c.date][0]=t;else{if("date-to"!==e)return;g[c.date][1]=t}d(),$("body").trigger("viewstate:change",[e])},getDates:function(){return g[c.date]},getFromDate:function(){return g[c.date][0]},getToDate:function(){return g[c.date][1]},setDisplay:function(t,e){if("sort"===e)g[c.display][0]=t;else if("desc"===e)g[c.display][1]=t;else{if("showtags"!==e)return;g[c.display][2]=t}d(),$("body").trigger("viewstate:change",e)},getDisplay:function(){return g[c.display]},getDisplaySort:function(){return g[c.display][0]},getDisplayDesc:function(){return g[c.display][1]},getDisplayShowtags:function(){return g[c.display][2]}}});