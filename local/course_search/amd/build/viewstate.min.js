define(["jquery","core/notification","core/log","core/ajax","core/templates","local_course_search/cookie","local_course_search/ld_loader"],function($,e,t,n,i,a,r){"use strict";t.debug("AMD module viewstate loaded.");var o="viewstate",s=null,u=null,g=[[],[],[],[],[]],c={view:0,text:1,tags:2,date:3,display:4},l="0|||0,0|name,0,0",d=function(){var e="",n=[];g.forEach(function(e){n.push(e.join(","))}),e=n.join("|"),a.create(o,e,14),t.debug(e)};return{viewstate:s,viewstatearray:g,init:function(){t.debug("AMD module viewstate init."),s=a.read(o),null===s&&(s=l,a.create(o,l)),u=s.split("|"),u.forEach(function(e,t){e.length?g[t]=e.split(","):g[t]=[]}),t.debug(s),t.debug(g)},setView:function(e){g[c.view][0]=e.toString(),d(),$("body").trigger("viewstate:change",["view"])},getView:function(){return g[c.view][0]},setText:function(e){g[c.text][0]=e.replace(",","").toLowerCase(),d(),$("body").trigger("viewstate:change",["text"])},getText:function(){var e="";return g[c.text].length&&(e=g[c.text][0]),e},setTag:function(e,t){"remove"===t?r.remove(g[c.tags],function(t){return t.toString()===e.toString()}):-1===g[c.tags].indexOf(e.toString())&&g[c.tags].push(e.toString()),d(),$("body").trigger("viewstate:change",["tag"])},removeTags:function(e){var t=[];t=r.difference(g[c.tags],e),g[c.tags]=t,d()},getTags:function(){return g[c.tags]},setDate:function(e,t){if("date-from"===t)g[c.date][0]=e;else{if("date-to"!==t)return;g[c.date][1]=e}d(),$("body").trigger("viewstate:change",[t])},getDates:function(){return g[c.date]},getFromDate:function(){return g[c.date][0]},getToDate:function(){return g[c.date][1]},setDisplay:function(e,t){if("sort"===t)g[c.display][0]=e;else if("desc"===t)g[c.display][1]=e;else{if("showtags"!==t)return;g[c.display][2]=e}d(),$("body").trigger("viewstate:change",t)},getDisplay:function(){return g[c.display]},getDisplaySort:function(){return g[c.display][0]},getDisplayDesc:function(){return g[c.display][1]},getDisplayShowtags:function(){return g[c.display][2]}}});